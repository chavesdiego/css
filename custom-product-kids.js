"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(n){var o={};function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=n,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===(void 0===t?"undefined":_typeof(t))&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}({"./src/assets/js/custom-product-kids/custom-product-kids.js":function srcAssetsJsCustomProductKidsCustomProductKidsJs(module,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _sku_selection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./sku-selection */ \"./src/assets/js/custom-product-kids/sku-selection/index.js\");\n/* harmony import */ var _sku_attachment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./sku-attachment */ \"./src/assets/js/custom-product-kids/sku-attachment/index.js\");\n\n\n\n\nconst embroideryRow = []\nconst item = { quantity: 1, seller: 1, id: null }\nwindow.addEventListener('skuchange', ({ detail: id }) => { item.id = id })\n\n\nwindow.addEventListener('child.added', ({ detail }) => {\n  Object(_sku_attachment__WEBPACK_IMPORTED_MODULE_1__[\"default\"])().addItem(detail)\n  embroideryRow.push(detail === 'boy' ? 'Menino' : 'Menina')\n  updateEmbroideryRowIndexes()\n})\n\nwindow.addEventListener('child.removed', ({ detail }) => {\n  embroideryRow.splice(detail, 1)\n  updateEmbroideryRowIndexes()\n})\n\n\nconst updateEmbroideryRowIndexes = () => {\n  const pickerButtons = document.querySelectorAll('#picker button')\n  const selectionRowButtons = document.querySelectorAll('#row-selection button')\n  \n  selectionRowButtons\n    .forEach((btn, i) => btn.setAttribute('data-index', i))\n\n  if(embroideryRow.length === 10) {\n    pickerButtons.forEach(btn => btn.setAttribute('disabled', 'disabled'))\n  } else {\n    pickerButtons.forEach(btn => btn.removeAttribute('disabled'))\n  }\n\n  console.log(embroideryRow)\n}\n\nconst added = () => {\n  swal({\n    icon: 'success',\n    text: 'Produto adicionado ao carrinho!',\n    buttons: {\n      cart: { text: 'ver carrinho', value: 'cart' },\n      continue: { text: 'escolher mais produtos', value: 'continue' }\n    }\n  })\n    .then(value => {\n      switch (value) {\n        case \"cart\":\n          window.location.assign('http://jchermann.com/checkout')\n          break;\n        case \"continue\":\n          window.location.assign('http://jchermann.com/busca')\n          break;\n        default:\n          return true\n      }\n\n    })\n}\n\nconst customProduct = () => {\n  const sku = Object(_sku_selection__WEBPACK_IMPORTED_MODULE_0__[\"default\"])()\n  const input = Object(_sku_attachment__WEBPACK_IMPORTED_MODULE_1__[\"default\"])()\n  const addToCartButton = document.getElementById('button_add-to-cart')\n  let currentItemIndex = null;\n\n\n  const onAddToCart = async () => {\n    if (!item.id) {\n      swal({ icon: 'info', text: 'Escolha um tamanho' });\n      return;\n    }\n\n    try {\n      document.body.classList.add('loading');\n      const updatedOrderForm = await vtexjs.checkout.addToCart([item], null).then(orderForm => orderForm)\n      const currentItem = updatedOrderForm.items.filter(i => i.id == item.id).slice(-1)[0];\n      currentItemIndex = updatedOrderForm.items.findIndex(i => i.uniqueId == currentItem.uniqueId);\n      const itemOfering = currentItem.offerings.filter(c => c.attachmentOfferings.some(o => o.name === 'Bordado'))\n\n      const offeringId = itemOfering[0].id\n      const attachmentData = { Bordado: embroideryRow.join(', ') }\n\n      await vtexjs.checkout.addOffering(offeringId, currentItemIndex) \n\n      const attachment = await vtexjs.checkout\n        .addBundleItemAttachment(currentItemIndex, offeringId, \"Bordado\", attachmentData)\n\n      const currentAddedItemError = attachment.messages.filter(m => m.fields.skuName === currentItem.skuName)\n\n      if (currentAddedItemError.length) {\n        vtexjs.checkout.removeItems([{ index: currentItemIndex, quantity: 0 }], null);\n        swal({ icon: 'error', text: currentAddedItemError[0].text });\n      } else {\n        added()\n      }\n\n    } catch (err) {\n      console.log(err)\n      const text = \"Erro ao personalizar\"\n      vtexjs.checkout.removeItems([{ index: currentItemIndex, quantity: 0 }], null);\n      swal({\n        icon: 'error',\n        text: `\n          Erro ao customizar o produto. Tente novamente.\n        `\n      });\n    } finally {\n      document.body.classList.remove('loading');\n    }\n  }\n\n  const init = () => {\n    sku.createSkuSelectionComponent()\n    input.init()\n    addToCartButton.addEventListener('click', onAddToCart);\n  }\n\n  return {\n    init\n  }\n}\n\n\ncustomProduct().init()\n\n//# sourceURL=webpack:///./src/assets/js/custom-product-kids/custom-product-kids.js?")},"./src/assets/js/custom-product-kids/sku-attachment/index.js":function srcAssetsJsCustomProductKidsSkuAttachmentIndexJs(module,__webpack_exports__,__webpack_require__){eval('__webpack_require__.r(__webpack_exports__);\nconst skuAttachmentInput = () => {\n  const wrapper = document.getElementById(\'sku-service\')\n  const div = document.createElement(\'div\')\n  const message = document.createElement(\'p\')\n  const selection = document.createElement(\'div\')\n  const girl = `<svg height="100" width="100" version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45.833 100"><path d="M29.775 18.047c5.697 0 8.008 4.695 8.871 7.283l6.999 23.008c1.396 4.949-4.899 6.998-6.4 2.175l-6.298-21.125h-1.833L42.03 66.966H31.973v29.296c0 4.996-7.514 4.971-7.514 0V66.774h-3.063l.005 29.447c0 5.037-7.545 5.037-7.545 0l-.002-29.255H3.765l10.831-37.578h-1.694l-6.299 21.2c-1.5 4.621-7.85 2.724-6.396-2.228L7.2 25.33c.749-2.625 3.045-7.283 8.795-7.283h13.78z"/><circle cx="22.925" cy="8.164" r="8.164"/></svg>`\n  const boy = `<svg height="100" width="100" version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 37.207 100"><circle cx="18.118" cy="8.159" r="8.159"/><path d="M8.472 95.426a4.575 4.575 0 009.15 0l.004-38.374h2.037l-.013 38.374a4.575 4.575 0 009.147 0l.02-66.158h2.006v24.38c0 4.905 6.398 4.905 6.384 0v-24.9c0-5.418-3.184-10.728-9.523-10.728l-18.288-.008C3.619 18.012 0 22.722 0 28.599v25.05c0 4.869 6.433 4.869 6.433 0v-24.38h2.048l-.009 66.157z"/></svg>`\n\n  div.innerHTML = `\n    <button data-value="boy">${boy}</button>\n    <button data-value="girl">${girl}</button>\n  ` \n\n  message.innerHTML = `clique nas imagens acima para personalziar sua peÃ§a :)`\n\n\n  const onAddChild = ({ target }) => {\n    const value = target.getAttribute(\'data-value\')\n    const evt = new CustomEvent(\'child.added\', { detail: value })\n    window.dispatchEvent(evt)\n  }\n\n  const onRemoveChild = ({ target }) => {\n    const evt = new CustomEvent(\'child.removed\', { detail: target.getAttribute(\'data-index\') })\n    target.remove()\n    window.dispatchEvent(evt)\n  }\n\n  const addItem = (item) => {\n    const btnItem = document.createElement(\'button\');\n    btnItem.innerHTML = `${item === \'boy\' ? boy : girl }`\n    btnItem.addEventListener(\'click\', onRemoveChild)\n    document.querySelector(\'#row-selection\').appendChild(btnItem)\n\n  }\n\n  const init = () => {\n    selection.id = \'row-selection\'\n    div.id = \'picker\'\n\n    wrapper.appendChild(div)\n    wrapper.appendChild(message)\n    wrapper.appendChild(selection)\n    \n    div.querySelectorAll(\'button\')\n      .forEach(button => button.addEventListener(\'click\', onAddChild))\n  }\n\n  return {\n    init,\n    addItem\n  }\n}\n\n/* harmony default export */ __webpack_exports__["default"] = (skuAttachmentInput);\n\n//# sourceURL=webpack:///./src/assets/js/custom-product-kids/sku-attachment/index.js?')},"./src/assets/js/custom-product-kids/sku-selection/index.js":function srcAssetsJsCustomProductKidsSkuSelectionIndexJs(module,__webpack_exports__,__webpack_require__){eval("__webpack_require__.r(__webpack_exports__);\nconst skuSelection = () => {\n  const fetchCurrentProduct = () => vtexjs.catalog.getCurrentProductWithVariations()\n  const skuSelectionWrapper = document.getElementById('sku-selection')\n  \n  const onSkuSelect = ({ target }) => {\n    const onSkuChange = new CustomEvent(\n      'skuchange',\n       { detail: target.dataset.sku } \n    )\n\n    const previousSelected = document.querySelector('.sku-selection-button.selected')\n    previousSelected && previousSelected.classList.remove('selected')\n    target.classList.toggle('selected')\n    \n    window.dispatchEvent(onSkuChange)\n  }\n\n  const skuSelectionButton = ({ sku, skuname, available }) => {\n    const button = document.createElement('button')\n\n    button.className = 'sku-selection-button'\n    button.innerHTML = skuname\n    button.setAttribute('data-sku', sku)\n    button.addEventListener('click', onSkuSelect)\n\n    if(!available){\n      button.setAttribute('disabled', 'disabled')\n    }\n\n    return button\n  }\n\n  const createSkuSelectionComponent = async() => {\n    const fragment = document.createDocumentFragment()\n    const product = await fetchCurrentProduct()\n    \n    product.skus.map(sku => \n      fragment.append(skuSelectionButton(sku))\n    )\n\n    skuSelectionWrapper.appendChild(fragment)\n  }\n\n  return {\n    createSkuSelectionComponent\n  }\n}\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (skuSelection);\n\n//# sourceURL=webpack:///./src/assets/js/custom-product-kids/sku-selection/index.js?")},3:function _(module,exports,__webpack_require__){eval('module.exports = __webpack_require__(/*! /Users/diegochaves/Projects/vtex-jchermann/src/assets/js/custom-product-kids/custom-product-kids.js */"./src/assets/js/custom-product-kids/custom-product-kids.js");\n\n\n//# sourceURL=webpack:///multi_./src/assets/js/custom-product-kids/custom-product-kids.js?')}});